<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test SegurBot Widget - Vercel Deployment</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #253878;
            margin-bottom: 20px;
        }
        
        .test-info {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
            max-width: 300px;
        }

        .status-good { color: #4CAF50; }
        .status-error { color: #f44336; }
        .status-warning { color: #ff9800; }
    </style>
</head>
<body>
    <div class="debug-panel">
        <div><strong>üß™ Test Widget Vercel</strong></div>
        <div id="debug-info">Cargando desde Vercel...</div>
    </div>

    <div class="test-container">
        <h1>ü§ñ SegurBot Widget - Test Final desde Vercel</h1>
        
        <div class="test-info">
            <h3>üéØ Verificaci√≥n de estilos completos</h3>
            <p><strong>Cargando desde:</strong> <code>https://chatbotfrontend-theta.vercel.app/dist/segurbot-widget.umd.js</code></p>
            
            <h4>‚úÖ Checklist de estilos:</h4>
            <ul>
                <li><span id="check-button">‚è≥</span> Bot√≥n flotante con dimensiones correctas</li>
                <li><span id="check-icons">‚è≥</span> Iconos con tama√±o apropiado (text-2xl)</li>
                <li><span id="check-container">‚è≥</span> Contenedor del chat (w-80 sm:w-96 h-[32em])</li>
                <li><span id="check-header">‚è≥</span> Header con estilos completos</li>
                <li><span id="check-input">‚è≥</span> Input √°rea sin deformaciones</li>
                <li><span id="check-responsive">‚è≥</span> Responsive (sm: breakpoints)</li>
            </ul>
        </div>

        <div style="height: 400px; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc; margin: 20px 0;">
            <div style="text-align: center; color: #666;">
                <p><strong>√Årea de contenido de prueba</strong></p>
                <p>El widget debe aparecer en la esquina inferior derecha</p>
                <p>Haz clic para abrir y verifica que todos los estilos se apliquen correctamente</p>
            </div>
        </div>

        <div class="test-info">
            <h4>üîç Qu√© verificar:</h4>
            <ol>
                <li>El bot√≥n flotante debe tener bordes azules y sombra</li>
                <li>Los iconos deben ser del tama√±o correcto (no demasiado grandes o peque√±os)</li>
                <li>La ventana del chat debe tener 20rem/24rem de ancho y altura fija</li>
                <li>El header debe tener gradiente y iconos bien posicionados</li>
                <li>El input debe tener bordes redondeados y padding apropiado</li>
                <li>No debe haber elementos que se salgan de sus contenedores</li>
            </ol>
        </div>
    </div>

    <!-- Cargar el widget desde Vercel -->
    <script src="https://chatbotfrontend-theta.vercel.app/dist/segurbot-widget.umd.js"></script>
    <script>
        console.log('üöÄ Iniciando test desde Vercel...');
        
        let checkInterval;
        let widget;
        
        function updateCheck(elementId, status, text) {
            const element = document.getElementById(elementId);
            if (element) {
                const icon = status === 'good' ? '‚úÖ' : status === 'error' ? '‚ùå' : status === 'warning' ? '‚ö†Ô∏è' : '‚è≥';
                element.textContent = icon;
                element.className = `status-${status}`;
                if (text) {
                    element.title = text;
                }
            }
        }
        
        function checkStyles() {
            const container = document.getElementById('segurbot-widget');
            const button = container?.querySelector('button[aria-label*="chat"]');
            const chatWindow = container?.querySelector('.fixed.bottom-25');
            
            // Check button
            if (button) {
                const buttonStyles = window.getComputedStyle(button);
                const hasCorrectBorder = buttonStyles.borderWidth === '4px';
                const hasCorrectBackground = buttonStyles.backgroundColor.includes('15') || buttonStyles.backgroundColor.includes('3, 7, 15');
                updateCheck('check-button', hasCorrectBorder && hasCorrectBackground ? 'good' : 'warning', 
                    `Border: ${buttonStyles.borderWidth}, BG: ${buttonStyles.backgroundColor}`);
            } else {
                updateCheck('check-button', 'error', 'Bot√≥n no encontrado');
            }
            
            // Check icons
            const icons = container?.querySelectorAll('svg');
            if (icons && icons.length > 0) {
                let correctSizedIcons = 0;
                icons.forEach(icon => {
                    const iconStyles = window.getComputedStyle(icon);
                    if (iconStyles.width.includes('1.5rem') || iconStyles.width.includes('24px')) {
                        correctSizedIcons++;
                    }
                });
                updateCheck('check-icons', correctSizedIcons > 0 ? 'good' : 'warning', 
                    `${correctSizedIcons}/${icons.length} iconos con tama√±o correcto`);
            }
            
            // Check container
            if (chatWindow) {
                const containerStyles = window.getComputedStyle(chatWindow);
                const hasCorrectWidth = containerStyles.width.includes('20rem') || containerStyles.width.includes('24rem') || containerStyles.width.includes('320px') || containerStyles.width.includes('384px');
                const hasCorrectHeight = containerStyles.height.includes('32em') || containerStyles.height.includes('512px');
                updateCheck('check-container', hasCorrectWidth && hasCorrectHeight ? 'good' : 'warning',
                    `Width: ${containerStyles.width}, Height: ${containerStyles.height}`);
            } else {
                updateCheck('check-container', chatWindow === null ? 'warning' : 'error', 'Chat cerrado o no encontrado');
            }
            
            // Check header
            const header = chatWindow?.querySelector('.bg-Blue');
            updateCheck('check-header', header ? 'good' : 'warning', header ? 'Header encontrado' : 'Header no visible');
            
            // Check input
            const input = chatWindow?.querySelector('textarea');
            if (input) {
                const inputStyles = window.getComputedStyle(input);
                const hasRoundedCorners = inputStyles.borderRadius.includes('0.75rem') || inputStyles.borderRadius.includes('12px');
                updateCheck('check-input', hasRoundedCorners ? 'good' : 'warning', 
                    `Border radius: ${inputStyles.borderRadius}`);
            } else {
                updateCheck('check-input', 'warning', 'Input no visible');
            }
            
            // Check responsive (simplified)
            const isSmallScreen = window.innerWidth <= 640;
            updateCheck('check-responsive', 'good', `Screen: ${window.innerWidth}px (${isSmallScreen ? 'Mobile' : 'Desktop'})`);
        }
        
        try {
            widget = new SegurBotWidget({
                apiUrl: 'https://segurbot-backend.vercel.app/api/chat',
                title: 'SegurBot - Test Final',
                initialMessage: '¬°Hola! Soy SegurBot con todos los estilos corregidos. ¬øC√≥mo me veo ahora?',
                enableDebug: true
            });

            widget.init();
            
            document.getElementById('debug-info').innerHTML = 
                '<span class="status-good">Widget cargado desde Vercel ‚úÖ</span><br>' +
                'Versi√≥n: Estilos completos<br>' +
                'Estado: Verificando estilos...';

            // Start style checking
            setTimeout(() => {
                checkStyles();
                checkInterval = setInterval(checkStyles, 3000);
            }, 2000);

        } catch (error) {
            console.error('‚ùå Error al cargar widget desde Vercel:', error);
            document.getElementById('debug-info').innerHTML = '<span class="status-error">Error: ' + error.message + '</span>';
        }
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (checkInterval) {
                clearInterval(checkInterval);
            }
        });
    </script>
</body>
</html>
